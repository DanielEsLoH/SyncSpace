#!/bin/bash
set -e

export DATABASE_URL="postgresql://postgres:postgres@db:5432/syncspace_test"
export RAILS_ENV=test

echo "Setting up test database..."
# Create database if it doesn't exist (ignore error if it already exists)
COVERAGE=false bin/rails db:create 2>/dev/null || true
# Run migrations
COVERAGE=false bin/rails db:migrate

echo "Running tests..."
bundle exec rspec "$@"
